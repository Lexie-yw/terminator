{% extends "base.html" %}
{% load guardian_tags %}
{% load i18n %}

{% comment %}
Copyright 2011 Leandro Regueiro

This file is part of Terminator.

Terminator is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

Terminator is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with Terminator.  If not, see <http://www.gnu.org/licenses/>.
{% endcomment %}

{% block title %}
    {% blocktrans %}{{ glossary }} — Terminator{% endblocktrans %}
{% endblock %}

{% block breadcrumbs %}
    » <a href="{% url "terminator_glossary_list" %}">{% trans "Glossaries" %}</a>
    » <a href="{% url "terminator_glossary_detail" pk=glossary.pk %}">{{ glossary }}</a>
{% endblock %}


{% block content %}
    
    {% get_obj_perms user for glossary as "glossary_perms" %}
    
    
    <h1><img src="{{ STATIC_PREFIX }}images/icon_glossary_32.png" />{{ glossary.name }}</h1>
    
    <p>{{ glossary.description|linebreaks }}</p>
    {% if "is_owner_for_this_glossary" in glossary_perms %}
        <p><a href="{% url "admin:terminator_glossary_change" glossary.pk %}"><img src="{{ STATIC_PREFIX }}images/icon_edit_16.png" />{% trans "edit this glossary" %}</a></p>
    {% endif %}

    <h3>{% blocktrans %}Concepts{% endblocktrans %}</h3>
    
    <ul class="iconlist vertflexlist">
    {% for concept in glossary.concept_set.all|slice:":19" %}
        <li class="conceptitem"><a href="{% url "terminator_concept_detail" pk=concept.pk %}">{{ concept }}</a></li>
    {% endfor %}
    {% if glossary.concept_set.all.count > 21 %}
        <li class="conceptitem">...</li>
        <li><b><a href="{% url "terminator_glossary_concepts" pk=glossary.pk %}"><img src="{{ STATIC_PREFIX }}images/icon_glossary_16.png" />{% trans "See all concepts in this glossary" %}</a></b></li>
    {% else %}
      {% for concept in glossary.concept_set.all|slice:"19:21" %}
        <li class="conceptitem"><a href="{% url "terminator_concept_detail" pk=concept.pk %}">{{ concept }}</a></li>
      {% endfor %}
    {% endif %}
    </ul>
    {% if "is_lexicographer_in_this_glossary" in glossary_perms %}
        <p><a href="{% url "admin:terminator_concept_add" %}?glossary={{ glossary.pk }}"><img src="{{ STATIC_PREFIX }}images/icon_add_16.png" /> {% trans "add a new concept to this glossary" %}</a></p>
    {% endif %}
    

    {% if user.is_authenticated %}
        <h3>{% blocktrans %}Glossary collaborators{% endblocktrans %}</h3>
        {% with glossary.get_collaborators as collaborators %}
            {% if collaborators %}
                <ul class="iconlist vertflexlist">
                {% for collaborator in collaborators %}
                    <li class="useritem">
                        {% url "profiles_profile_detail" username=collaborator.user as profile_url %}
                        {% blocktrans with collaborator=collaborator.user role=collaborator.role %}<a href="{{ profile_url }}">{{ collaborator }}</a> as {{ role }}{% endblocktrans %}
                    </li>
                {% endfor %}
                </ul>
            {% else %}
                <p>{% blocktrans %}This glossary has no collaborators.{% endblocktrans %}</p>
            {% endif %}
        {% endwith %}
        
        <p>{% blocktrans %}Do you want to receive e-mail notifications of all comments in this glossary?{% endblocktrans %}</p>
        
        {% include "glossary_subscribe_form_snippet.html" %}
        
        <p>{% blocktrans %}Do you want to collaborate on this glossary?{% endblocktrans %}</p>
        
        {% include "glossary_collaboration_request_form_snippet.html" %}
    {% endif %}

    {% if features.export_tbx %}
        <p><a href="{% url "terminator_export" %}?from_glossaries={{ glossary.pk }}"><img src="{{ STATIC_PREFIX }}images/icon_tbx_16.png" /> {% trans "export glossary to TBX" %}</a></p>
    {% endif %}

{% endblock %}
